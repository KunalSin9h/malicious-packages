{
    "modified": "2025-05-17T06:38:42.188Z",
    "published": "2025-05-17T06:38:42.188Z",
    "schema_version": "1.5.0",
    "summary": "Malicious code in ts-runtime-compat-check package (npm)",
    "details": "The npm package `ts-runtime-compat-check` is a malicious package that functions as a key component in a remote code execution attack chain. This package:\n\n1. Contains a `postinstall` script that executes `lib/install.js`\n\n2. The install script makes HTTP requests to a server specified by an environment variable `APP_PROXY` (defaults to 'http://localhost' but typically set to `https://proxy.eslint-proxy.site` by parent packages)\n\n3. Sends the victim's application path as a query parameter to the malicious server\n\n4. When the server returns specially crafted error messages, the package decodes them from base64 and executes them using `new Function.constructor()`\n\n5. This creates a direct remote code execution capability\n\nThis package is utilized by other malicious packages like `eslint-config-airbnb-compat` to establish a covert channel for executing arbitrary code. The separation of concerns across multiple packages appears designed to evade detection by security scanners.",
    "affected": [
        {
        "package": {
            "ecosystem": "npm",
            "name": "ts-runtime-compat-check"
        },
        "ranges": [
            {
            "type": "SEMVER",
            "events": [
                {
                "introduced": "0.0.0"
                }
            ]
            }
        ]
        }
    ],
    "credits": [
        {
            "name": "Safedep",
            "type": "FINDER",
            "contact": [
                "https://safedep.io/"
            ]
        }
    ]
}
